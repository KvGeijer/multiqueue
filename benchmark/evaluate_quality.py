#! /usr/bin/env python3

import numpy as np
import pandas as pd
import pathlib
import argparse

parser = argparse.ArgumentParser(
    description="Parses the logs generated by the quality benchmars")
parser.add_argument("insertion_file", metavar="IN",
                    type=pathlib.Path, help="The log of the insertions")
parser.add_argument("deletion_file", metavar="DEL",
                    type=pathlib.Path, help="The log of the deletions")

args = parser.parse_args()
ins_data = pd.read_csv(args.insertion_file, sep=' ',
                       names=["thread", "tick", "key"])
del_data = pd.read_csv(args.deletion_file, sep=' ', names=[
                       "thread", "tick", "from_thread", "id"])

ins_data.sort_values(by="key", inplace=True, ignore_index=True)
print(ins_data.head(10))
